# adapted from libudis86 Makefile

CC      = @CC@
DEPFLAG = -Wp,-MD,.$@.d
CFLAGS  = -Wall -O2 $(DEPFLAG)
AR      = ar
RM      = rm
PERL    = perl

.SUFFIXES: .c .o

SRCS = \
	decode.c \
	input.c \
	mnemonics.c \
	opcmap.c \
	syn.c \
	syn-intel.c \
	syn-att.c \
	udis86.c

OBJS = $(SRCS:%.c=%.o)

.PHONY: all clean

all: libudis86.a

include $(wildcard .*.d)

libudis86.a: $(OBJS)
	$(AR) -r libudis86.a $(OBJS)

$(SRCS): mnemonics.h

mnemonics.c mnemonics.h: mnemonics.dat mnemonics.pl
	$(PERL) mnemonics.pl < $<

clean:
	$(RM) -f core *.o *.a mnemonics.c mnemonics.h .*.d

