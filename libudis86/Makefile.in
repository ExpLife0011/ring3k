# adapted from libudis86 Makefile

CC      = @CC@
DEPFLAG = -Wp,-MD,.$@.d
CFLAGS  = -Wall -O2 $(DEPFLAG)
AR      = ar
RM      = rm
PERL    = perl

.SUFFIXES: .c .o

.c.o:
	$(CC) -c $(CFLAGS) -o $@ $<

OBJS = mnemonics.o \
	opcmap.o \
	input.o \
	decode.o \
	syn.o \
	syn-intel.o \
	syn-att.o \
	udis86.o

.PHONY: all clean

all: libudis86.a

include $(wildcard .*.d)

libudis86.a: $(OBJS)
	$(AR) -r libudis86.a $(OBJS)

mnemonics.c mnemonsic.h: mnemonics.dat
	$(PERL) mnemonics.pl < mnemonics.dat

clean:
	$(RM) -f core *.o *.a mnemonics.c mnemonics.h .*.d

